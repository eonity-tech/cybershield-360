package com.cybershield.protection.core.domain.type;

public enum VulnerabilityLevel {

    // 1. OK -> "Sain" ou "Sécurisé"
    SAFE("Sécurisé", "text-green-500"),

    // 2. Avertissement -> "Faible" ou "Moyen"
    WARNING("Avertissement", "text-yellow-500"),

    // 3. Danger -> "Élevé" (Terme standard Cyber)
    HIGH("Risque Élevé", "text-orange-500"),

    // 4. Critique -> "Critique" (Urgence absolue)
    CRITICAL("Critique", "text-red-600");

    private final String label;
    private final String colorCode; // Code couleur pour l'interface

    VulnerabilityLevel(String label, String colorCode) {
        this.label = label;
        this.colorCode = colorCode;
    }

    public String getLabel() {
        return label;
    }

    public String getColorCode() {
        return colorCode;
    }

    /**
     * Méthode intelligente pour convertir le score (0-100) en Niveau
     */
    public static VulnerabilityLevel fromScore(double score) {
        if (score == 0) return SAFE;
        if (score < 40) return WARNING;
        if (score < 75) return HIGH;
        return CRITICAL;
    }
}